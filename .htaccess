# ===============================================
# REDIRECTIONS HTTPS ET NON-WWW
# ===============================================

RewriteEngine On

# Redirection de /index.html vers /
RewriteCond %{THE_REQUEST} /index\.html [NC]
RewriteRule ^(.*)index\.html$ /$1 [R=301,L]

# Redirection de /download vers la page d'accueil
RewriteRule ^download$ / [R=301,L]

# Retirer www (peu importe HTTP ou HTTPS)
RewriteCond %{HTTP_HOST} ^www\.kevin-ferraretto\.fr$ [NC]
RewriteRule ^(.*)$ https://kevin-ferraretto.fr/$1 [R=301,L]

# Forcer HTTPS uniquement si pas www (déjà géré au-dessus)
RewriteCond %{HTTPS} off
RewriteCond %{HTTP_HOST} ^kevin-ferraretto\.fr$ [NC]
RewriteRule ^(.*)$ https://kevin-ferraretto.fr/$1 [R=301,L]

# ===============================================
# HEADERS DE SÉCURITÉ
# ===============================================

Header set X-Frame-Options "SAMEORIGIN"
Header set X-XSS-Protection "1; mode=block"
Header set X-Content-Type-Options "nosniff"
Header set Referrer-Policy "strict-origin-when-cross-origin"
Header set Permissions-Policy "geolocation=(), microphone=(), camera=()"
Header set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline' https://unpkg.com; style-src 'self' 'unsafe-inline'; img-src 'self' https://skillicons.dev data:; font-src 'self'; connect-src 'self'"
